<!DOCTYPE html>
<html>
	<head>
		<title>Image Compression App</title>
		        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
	</head>
	<body>
		<h1>Image Compression</h1>
		<form action="/compress" method="POST" enctype="multipart/form-data">
			<label for="image">Select an Image:</label>
			<input type="file" name="image" id="image" accept=".jpg, .jpeg, .png">
			<button type="submit">Compress Image</button>
		</form>
		<div id="result">
			<div id="loading" style="display: none;">Compressing image... Please wait.</div>
			<img id="compressedImage" src="" alt="Compressed Image">
			<div id="error" style="color: red;"></div>
		</div>
		<script>
			document.querySelector('form').addEventListener('submit', async (e) => {
				e.preventDefault();
				document.querySelector('#loading').style.display = 'block';
				document.querySelector('#error').style.display = 'none';
				
				const formData = new FormData(e.target);
				const response = await fetch('/compress', {
					method: 'POST',
					body: formData
				})
				if (response.ok) {
					const blob = await response.blob();
					const url = URL.createObjectURL(blob);
					document.querySelector('#compressedImage').src = url;
				} else {																			                const errorText = await response.text();
					document.querySelector('#error').textContent = 'Error: ' + errorText;																				            }
				document.querySelector('#loading').style.display = 'none'
			}); 
		</script>
	</body>
</html>
